"use strict";(self.webpackChunkreact_member_center=self.webpackChunkreact_member_center||[]).push([[601],{86477:function(e,t,a){a.r(t),a.d(t,{default:function(){return z}});var n=a(1413),i=a(74165),s=a(15861),c=a(29439),r=a(72791),l=a(33168),d=a(70819),u=a(60151),o=a(83734),m=a(77483),p=a(50419),h=a(66106),f=a(30914),x=a(68678),v=a(32014),_=a(93020),j=a(68747),Z=(a(60480),a(71823)),y=a(96969),g=a(46143),N=a(80184),b=o.Z.Option,k=null;function z(){var e=(0,r.useState)(null),t=(0,c.Z)(e,2),z=t[0],C=t[1],w=(0,r.useState)(3e5),S=(0,c.Z)(w,2),I=S[0],F=S[1],P=(0,d.s0)(),V=(0,l.$)().t,B=(0,r.useState)([]),q=(0,c.Z)(B,2),G=q[0],R=q[1],E=(0,r.useState)([]),O=(0,c.Z)(E,2),J=O[0],T=O[1],W=(0,r.useState)([]),A=(0,c.Z)(W,2),D=A[0],H=A[1],L=(0,r.useState)([{id:1,label:"xfs",value:"xfs"},{id:2,label:"ext4",value:"ext4"},{id:3,label:"ext3",value:"ext3"}]),X=(0,c.Z)(L,2),$=X[0],K=(X[1],(0,r.useState)(0)),M=(0,c.Z)(K,2),Q=M[0],U=M[1],Y=(0,r.useState)([]),ee=(0,c.Z)(Y,2),te=ee[0],ae=ee[1],ne=(0,r.useState)([]),ie=(0,c.Z)(ne,2),se=ie[0],ce=ie[1],re=(0,r.useState)([]),le=(0,c.Z)(re,2),de=le[0],ue=le[1],oe=(0,r.useState)([]),me=(0,c.Z)(oe,2),pe=me[0],he=me[1],fe=(0,r.useState)([]),xe=(0,c.Z)(fe,2),ve=xe[0],_e=xe[1],je=m.Z.useForm(),Ze=(0,c.Z)(je,1)[0],ye=(0,r.useState)({type_id:1,isChecked:!1,qty:1,duration_price_id:1}),ge=(0,c.Z)(ye,2),Ne=ge[0],be=ge[1],ke=(0,r.useState)(!1),ze=(0,c.Z)(ke,2),Ce=ze[0],we=ze[1],Se=(0,r.useState)(""),Ie=(0,c.Z)(Se,2),Fe=Ie[0],Pe=Ie[1],Ve=(0,r.useState)(!1),Be=(0,c.Z)(Ve,2),qe=Be[0],Ge=Be[1],Re=(0,r.useRef)(),Ee=(0,r.useState)(""),Oe=(0,c.Z)(Ee,2),Je=Oe[0],Te=Oe[1],We=(0,r.useState)(JSON.parse(localStorage.getItem("font_config"))),Ae=(0,c.Z)(We,1)[0],De=(0,r.useState)(),He=(0,c.Z)(De,2),Le=He[0],Xe=He[1],$e=(0,r.useState)({}),Ke=(0,c.Z)($e,2),Me=Ke[0],Qe=Ke[1],Ue=(0,r.useState)([]),Ye=(0,c.Z)(Ue,2),et=Ye[0],tt=Ye[1],at=(0,r.useState)(),nt=(0,c.Z)(at,2),it=nt[0],st=nt[1],ct=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.zC)();case 3:t=e.sent,T(t.data.data.list),Ze.setFieldsValue({host_id:t.data.data.list[0].id}),rt(t.data.data.list[0].id),pt(t.data.data.list[0].id),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),rt=function(e){var t={id:e};(0,y.Dj)(t).then((function(e){200===e.data.status&&Xe(e.data.data.data_center)}))},lt=(0,r.useState)(1),dt=(0,c.Z)(lt,2),ut=dt[0],ot=dt[1],mt=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ze.setFieldsValue({host_id:t}),rt(t),pt(t),tt([]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pt=function(e){var t={id:34,host_id:e};(0,y.VR)(t).then((function(e){200===e.data.status&&(R(e.data.data.package),e.data.data.package.length>0&&(be((0,n.Z)((0,n.Z)({},Ne),{},{type_id:e.data.data.package[0].id})),st({size_min:e.data.data.package[0].size_min,size_max:e.data.data.package[0].size_max}),Ze.setFieldsValue({type_id:e.data.data.package[0].id}),vt(e.data.data.package[0].id)))})).catch((function(e){}))},ht=function(e){var t=e.target.getAttribute("data-id");be((0,n.Z)((0,n.Z)({},Ne),{},{type_id:t})),Ze.setFieldsValue({type_id:t}),vt(t),G.map((function(e){e.id==t&&st({size_min:e.size_min,size_max:e.size_max})})),_t(),tt([])},ft=function(e){Ze.setFieldsValue({size:e}),be((0,n.Z)((0,n.Z)({},Ne),{},{size:e})),_t()},xt=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ze.validateFields().then(function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var a,n,s,c,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=Re.current.input.value){e.next=4;break}return e.abrupt("return",!1);case 4:if(!et.find((function(e){return e.name===a}))){e.next=6;break}return e.abrupt("return",(0,u.vC)(V("cloud.tip31"),"error"));case 6:if(!et.find((function(e){return!e.overlay}))){e.next=8;break}return e.abrupt("return",(0,u.vC)(V("cloud.tip32"),"error"));case 8:return e.next=10,Z.Td({promo_code:a,scene:"New",total:Number(Me.price),cycles:[{product_id:Ne.product_id,amount:Me.price,billing_cycle_time:Me.duration,config_options:{package_id:t.type_id,host_id:t.host_id,size:Number(t.size),mount_enable:t.isChecked?1:0,file_system:t.system?t.system:"",mount_path:t.way?t.way:"",duration_price_id:Ne.duration_price_id}}]});case 10:if(200!==(n=e.sent).data.status){e.next=17;break}if(s=n.data.data,c=s.overlay,r=s.discount,!(et.length>0)||c){e.next=15;break}return e.abrupt("return",(0,u.vC)(V("cloud.tip32"),"error"));case 15:tt((function(e){var t=e;return e.push({name:a,num:r,overlay:c}),t})),Ge(!1);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),p.ZP.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vt=function(e){[20,50,100,200,500].forEach((function(t){var a={package_id:e,size:t};(0,y.RW)(a).then((function(e){if(200==e.data.status){var a=e.data.data.list;20==t&&ae(a),50==t&&ce(a),100==t&&ue(a),200==t&&he(a),500==t&&_e(a)}}))}))},_t=function(){var e=Ze.getFieldValue(),t=!0;if(e.size&&e.type_id||(t=!1),t){var a={package_id:e.type_id,size:e.size};(0,y.RW)(a).then((function(e){if(200===e.data.status&&e.data.data.list){var t=e.data.data.list;H(t),Qe({price:t[Q].price,billing_cycle:t[Q].display_name})}}))}},jt=function(e){z||C((function(t){return t=setInterval((0,s.Z)((0,i.Z)().mark((function a(){var n;return(0,i.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Z.LX(e||Fe);case 2:if(n=a.sent,F((function(e){return e-2e3})),"Paid"!==n.data.code){a.next=9;break}return(0,u.vC)(n.data.msg,"success",(function(){P("/storage",{replace:!0})})),clearInterval(t),we(!1),a.abrupt("return",!1);case 9:if("Paid"!==n.code&&0!==I){a.next=13;break}return clearInterval(t),we(!1),a.abrupt("return",!1);case 13:case"end":return a.stop()}}),a)}))),2e3)}))};return(0,r.useEffect)((0,s.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct();case 2:return e.abrupt("return",(function(){clearInterval(z)}));case 3:case"end":return e.stop()}}),e)}))),[]),(0,N.jsxs)("div",{className:"create-ip com-content",children:[(0,N.jsxs)("div",{className:"com-card",children:[(0,N.jsx)("div",{className:"box data-center",children:(0,N.jsx)("div",{className:"com-tit",children:(0,N.jsx)("h1",{className:"tit",children:"\u521b\u5efa\u78c1\u76d8"})})}),(0,N.jsx)("div",{className:"box vpc",children:(0,N.jsxs)(m.Z,{name:"vpc",layout:"vertical",form:Ze,initialValues:{type_id:1,isChecked:!1},children:[(0,N.jsx)(m.Z.Item,{label:"\u9009\u62e9\u5b9e\u4f8b",name:"host_id",rules:[{required:!0,message:V("select")+V("menu.cloud")}],children:(0,N.jsx)(o.Z,{onChange:mt,getPopupContainer:function(e){return e.parentElement},children:J.map((function(e){return(0,N.jsx)(b,{value:e.id,children:e.name},e.id)}))})}),(0,N.jsx)(m.Z.Item,{label:"\u78c1\u76d8\u7c7b\u578b",name:"type_id",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u78c1\u76d8\u7c7b\u578b"}],style:{marginBottom:0},children:(0,N.jsx)(h.Z,{gutter:{xs:8,sm:16,md:24,lg:30},children:G.length>0?G.map((function(e){return(0,N.jsx)(f.Z,{xs:{span:24},md:{span:12},lg:{span:8},children:(0,N.jsx)("div",{className:"item c-hover ".concat(e.id==1*Ne.type_id?"c-active":""),onClick:ht,"data-id":e.id,children:e.name})},e.id)})):null})}),(0,N.jsx)(m.Z.Item,{label:"\u5bb9\u91cf",children:(0,N.jsxs)("div",{className:"size-main",children:[(0,N.jsx)(m.Z.Item,{name:"size",style:{display:"inline-block",width:"1.67rem",marginBottom:0},rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5bb9\u91cf"},{validator:function(e,t,a){return t<it.size_min||t>it.size_max?Promise.reject("\u78c1\u76d8\u5bb9\u91cf\u5e94\u8be5\u5728".concat(it.size_min,"-").concat(it.size_max)):Promise.resolve()}}],children:(0,N.jsx)(x.Z,{onChange:function(e){k&&clearTimeout(k),k=setTimeout((function(){var t=e.target.value;if(t<it.size_min||t>it.size_max)return!1;be((0,n.Z)((0,n.Z)({},Ne),{},{size:t})),_t(),tt([])}),500)},style:{width:"1.57rem",height:".44rem"}})}),(0,N.jsx)("span",{style:{display:"inline-block",width:"24px",lineHeight:"32px",textAlign:"center"},children:"GB"}),(0,N.jsxs)("div",{className:"size-content",children:[te.length>0?(0,N.jsxs)("div",{className:"size-item ".concat(20==Ne.size?"active":""),onClick:function(){ft(20)},children:[(0,N.jsxs)("div",{className:"item-top",children:[Ae.currency_prefix,te[Q].price,"/",te[Q].display_name]}),(0,N.jsx)("div",{className:"item-bottom",children:"20GB"})]}):null,se.length>0?(0,N.jsxs)("div",{className:"size-item ".concat(50==Ne.size?"active":""),onClick:function(){ft(50)},children:[(0,N.jsxs)("div",{className:"item-top",children:[Ae.currency_prefix,se[Q].price,"/",se[Q].display_name]}),(0,N.jsx)("div",{className:"item-bottom",children:"50GB"})]}):null,de.length>0?(0,N.jsxs)("div",{className:"size-item ".concat(100==Ne.size?"active":""),onClick:function(){ft(100)},children:[(0,N.jsxs)("div",{className:"item-top",children:[Ae.currency_prefix,de[Q].price,"/",de[Q].display_name]}),(0,N.jsx)("div",{className:"item-bottom",children:"100GB"})]}):null,pe.length>0?(0,N.jsxs)("div",{className:"size-item ".concat(200==Ne.size?"active":""),onClick:function(){ft(200)},children:[(0,N.jsxs)("div",{className:"item-top",children:[Ae.currency_prefix,pe[Q].price,"/",pe[Q].display_name]}),(0,N.jsx)("div",{className:"item-bottom",children:"200GB"})]}):null,ve.length>0?(0,N.jsxs)("div",{className:"size-item ".concat(500==Ne.size?"active":""),onClick:function(){ft(500)},children:[(0,N.jsxs)("div",{className:"item-top",children:[Ae.currency_prefix,ve[Q].price,"/",ve[Q].display_name]}),(0,N.jsx)("div",{className:"item-bottom",children:"500GB"})]}):null]})]})}),(0,N.jsx)(m.Z.Item,{label:"\u81ea\u52a8\u6302\u8f7d\u5e76\u683c\u5f0f\u5316",name:"isChecked",valuePropName:"checked",children:(0,N.jsx)(v.Z,{children:"\u662f"})}),(0,N.jsx)(m.Z.Item,{label:"\u6587\u4ef6\u7cfb\u7edf",name:"system",style:{display:"inline-block",width:"3.9rem",marginRight:".3rem"},children:(0,N.jsx)(o.Z,{getPopupContainer:function(e){return e.parentElement},allowClear:!0,children:$.map((function(e){return(0,N.jsx)(b,{value:e.value,children:e.name},e.id)}))})}),(0,N.jsx)(m.Z.Item,{label:"\u642d\u8f7d\u8def\u5f84",name:"way",style:{display:"inline-block",width:"3.9rem"},children:(0,N.jsx)(x.Z,{size:"large",style:{height:".44rem"}})})]})})]}),(0,N.jsx)("div",{className:"total-box",children:(0,N.jsxs)("div",{className:"content",children:[(0,N.jsx)("div",{className:"item",children:(0,N.jsxs)("div",{className:"l-config",children:[(0,N.jsxs)("p",{className:"tit",children:[V("cloud.area"),"\uff1a"]}),Le&&(0,N.jsxs)("p",{className:"des",children:[(0,N.jsx)("img",{src:a(85995)("./".concat(Le.country_code,".png")),alt:"",className:"country"}),(0,N.jsxs)("span",{children:[Le.country,"/",Le.city," \xa0 ",Le.area]})]})]})}),(0,N.jsx)("div",{className:"item",children:(0,N.jsxs)("div",{className:"l-config",children:[(0,N.jsxs)("p",{className:"tit",children:[V("common.cycle"),"\uff1a"]}),D.length>0&&(0,N.jsx)(o.Z,{className:"cycle",onChange:function(e){be((0,n.Z)((0,n.Z)({},Ne),{},{duration_price_id:e})),ot(e);var t=D.findIndex((function(t){return t.id==e}));U(t);var a=D.filter((function(t){return t.id==e}));Qe({price:a[0].price,billing_cycle:a[0].display_name})},defaultValue:D[0].id,value:ut,children:D.map((function(e){return(0,N.jsxs)(b,{value:e.id,children:[Ae.currency_prefix,e.price,"/",e.display_name]},e.price)}))})]})}),(0,N.jsxs)("div",{className:"item",children:[(0,N.jsx)("div",{className:"l-config",children:(0,N.jsxs)("div",{className:"s-item",children:[(0,N.jsxs)("p",{className:"tit",children:[V("common.total_price"),"\uff1a"]}),Me&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("p",{className:"price",children:[Ae.currency_prefix,(0,N.jsx)("span",{className:"num",children:String((Me.price*Ne.qty-et.reduce((function(e,t){return e+1*t.num}),0)>=0?Me.price*Ne.qty-et.reduce((function(e,t){return e+1*t.num}),0):0).toFixed(2))}),"/",Me.billing_cycle]}),(0,N.jsx)("div",{className:"discount-list",children:et.length>0&&et.map((function(e,t){return(0,N.jsxs)("p",{className:"item",children:[(0,N.jsxs)("span",{className:"num",children:["-\xa5",e.num]}),(0,N.jsxs)("span",{children:["(",V("common.discount_code")+e.name,")",(0,N.jsx)(j.Z,{onClick:function(){return function(e){tt((function(t){var a=JSON.parse(JSON.stringify(t));return a.splice(e,1),a}))}(t)}})]})]},e.name)}))})]})]})}),(0,N.jsxs)("div",{className:"config",children:[(0,N.jsx)("p",{className:"tit"}),(0,N.jsxs)("div",{className:"bot",id:"bot",children:[(0,N.jsx)(_.Z,{placement:"bottomRight",getPopupContainer:function(){return document.getElementById("bot")},content:(0,N.jsxs)("div",{className:"discount",children:[(0,N.jsx)(x.Z,{placeholder:V("cloud.input_discount_code"),value:Je,ref:Re,onChange:function(e){Te(e.target.value)}}),(0,N.jsx)("span",{className:"close",onClick:xt,children:V("common.sure")})]}),trigger:"click",visible:qe,onVisibleChange:function(e){Ge(e),Te("")},children:(0,N.jsx)("span",{className:"discount_code",children:V("common.discount_code")})}),(0,N.jsx)("div",{className:"r-btn",children:(0,N.jsx)("p",{className:"checkout",onClick:function(){Ze.validateFields().then(function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var a,n,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],et.length>0&&et.map((function(e){a.push(e.name)})),n={product_id:34,config_options:{package_id:t.type_id,host_id:t.host_id,size:Number(t.size),mount_enable:t.isChecked?1:0,file_system:t.system?t.system:"",mount_path:t.way?t.way:"",duration_price_id:Ne.duration_price_id},customfield:{promo_code:a},qty:1},e.prev=3,e.next=6,(0,y.Wo)(n);case 6:200===(s=e.sent).data.status&&(c=s.data.data.order_id,we(!0),Pe(c),jt(c)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),p.ZP.error(e.t0.data.msg);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}))},children:"\u521b\u5efa\u5e76\u8d2d\u4e70"})})]})]})]})]})}),Ce&&Fe&&(0,N.jsx)(g.Z,{orderId:Fe,timer:z})]})}}}]);
//# sourceMappingURL=601.11afeacb.chunk.js.map
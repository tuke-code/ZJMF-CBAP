{"version":3,"file":"static/js/342.fa141401.chunk.js","mappings":"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","sources":["api/image.js","views/product/image/iso/Iso.jsx"],"sourcesContent":["import request from '../utils/request'\r\n\r\n/* 实例列表 */\r\nexport function getCloudList(params) {\r\n    return request.get(`/idcsmart_cloud`, { params });\r\n}\r\n\r\n/* 获取所有产品 */\r\nexport function getCloudListAll() {\r\n    return request.get(`/idcsmart_cloud/all`);\r\n}\r\n\r\n\r\n// 获取实例磁盘\r\nexport function getDiskList(id) {\r\n    return request.get(`/idcsmart_cloud/${id}/disk`);\r\n}\r\n\r\n// 快照\r\n// 快照列表\r\nexport function snapshotList() {\r\n    return request.get(`/snapshot`)\r\n}\r\n\r\n// 创建快照\r\nexport function createSnapshot(params){\r\n    return request.post(`/idcsmart_cloud/${params.id}/snapshot`,params)\r\n}\r\n\r\n// 快照还原\r\nexport function restoreSnapshot(params){\r\n    return request.post(`/idcsmart_cloud/${params.id}/snapshot/restore`,params)\r\n}\r\n// 删除快照\r\nexport function delSnapshot(params){\r\n    return request.delete(`/idcsmart_cloud/${params.id}/snapshot/${params.snapshot_id}`,params)\r\n}\r\n\r\n\r\n// 备份\r\n// 备份列表\r\nexport function backupList() {\r\n    return request.get(`/backup`)\r\n}\r\n\r\n// 删除备份\r\nexport function delBackup(params){\r\n    return request.delete(`/idcsmart_cloud/${params.id}/backup/${params.backup_id}`,params)\r\n}\r\n\r\n// 备份还原\r\nexport function restoreBackup(params){\r\n    return request.post(`/idcsmart_cloud/${params.id}/backup/restore`,params)\r\n}\r\n\r\n// 创建快照\r\nexport function createBackup(params){\r\n    return request.post(`/idcsmart_cloud/${params.id}/backup`,params)\r\n}\r\n\r\n// 模板\r\n// 模板列表\r\nexport function templateList() {\r\n    return request.get(`/template`)\r\n}\r\n\r\n// 创建模板\r\nexport function createTemplate(params){\r\n    return request.post(`/idcsmart_cloud/${params.id}/template`,params)\r\n}\r\n\r\n// 删除模板\r\nexport function delTemplate(params){\r\n    return request.delete(`/idcsmart_cloud/${params.id}/template/${params.template_id}`,params)\r\n}\r\n\r\n// iso\r\n// iso列表\r\nexport function isoList() {\r\n    return request.get(`/iso`)\r\n}","import React, { useState, useEffect } from 'react'\r\nimport './iso.less'\r\nimport { Table, Popover, Alert, Button, Modal, Row, Col, Input, Select, } from 'antd';\r\nimport {\r\n  EllipsisOutlined\r\n} from '@ant-design/icons';\r\nimport { isoList } from '@/api/image'\r\nimport Swal from \"sweetalert2\";\r\nimport { showDialog } from '@/utils/util';\r\nimport moment from 'moment';\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport default function Iso() {\r\n  const { t } = useTranslation()\r\n  const { Option } = Select;\r\n  const { TextArea } = Input;\r\n  // 数据相关\r\n  const [diskList, setDiskList] = useState([])\r\n  const [sForm, setSForm] = useState({\r\n    id: 0,\r\n    name: null,\r\n    disk_id: null\r\n  })\r\n  const [errMsg, setErrMsg] = useState(\"\")\r\n  const [visible, setVisible] = useState(false)\r\n  const [data, setData] = useState([\r\n    {\r\n      id: 0,\r\n      name: '模板1',\r\n      area: '中国',\r\n      create_time: '1231789',\r\n      host_name: '实例1',\r\n      country: '中国',\r\n      country_code: 'CN',\r\n      city: '重庆',\r\n    },\r\n    {\r\n      id: 1,\r\n      name: '模板2',\r\n      area: '中国',\r\n      create_time: '1231789',\r\n      host_name: '实例2',\r\n      country: '中国',\r\n      city: '重庆',\r\n    }\r\n  ])\r\n  const columns = [\r\n    {\r\n      title: \"名称\",\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      ellipsis: true,\r\n      width: 200\r\n    },\r\n    {\r\n      title: \"URL\",\r\n      dataIndex: 'create_time',\r\n      key: 'create_time',\r\n      ellipsis: true,\r\n      minWidth: 400,\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      dataIndex: 'id',\r\n      key: 'id',\r\n      width: 80,\r\n      render: (_, record) => (\r\n        <>\r\n          <div className=\"com-opt-pop\" id={'com-opt' + record.id}>\r\n            <Popover getPopupContainer={() => document.getElementById('com-opt' + record.id)}\r\n              content={\r\n                <>\r\n                  <p className=\"cloud-opt\" onClick={() => recoverItem(record)}>恢复</p>\r\n                  <p className=\"cloud-opt\" onClick={() => deleteItem(record)}>{t(\"common.delete\")}</p>\r\n                </>\r\n              } placement=\"topRight\">\r\n              <p className=\"opt-icon\"><EllipsisOutlined /></p>\r\n            </Popover>\r\n          </div>\r\n        </>\r\n      )\r\n    },\r\n  ]\r\n  const [loading, setLoading] = useState(false)\r\n\r\n\r\n  // 方法开始\r\n  // 获取模板列表\r\n  const getSnapshotList = () => {\r\n    setLoading(true)\r\n    isoList().then(res => {\r\n      setLoading(false)\r\n      if (res.data.status === 200) {\r\n        setData(res.data.data.list)\r\n      }\r\n    })\r\n  }\r\n\r\n  // 恢复\r\n  const recoverItem = (record) => {\r\n    Swal.fire({\r\n      title: `<p style='display:flex;font-size:18px'>恢复</p>`,\r\n      html: `<span>您将恢复实例${record.host_name}的磁盘<br />\r\n      ${moment(record.create_time * 1000).format(\"YYYY-MM-DD HH:mm\")}\r\n      创建的模板<br />当前所有数据丢失，请确认您需要恢复模板</span>`,\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#5C5EE4',\r\n      confirmButtonText: '确认',\r\n      cancelButtonText: '取消',\r\n      customClass: {\r\n        cancelButton: 'snapshot-cancel-button',\r\n      }\r\n    }).then(result => {\r\n      if (result.value) {\r\n        // 调用恢复 模板\r\n      }\r\n    })\r\n  }\r\n\r\n  // 删除\r\n  const deleteItem = (record) => {\r\n    Swal.fire({\r\n      html: `<span>您将删除实例${record.host_name}的磁盘创建的镜像<br />\r\n      当前所有数据丢失，请确认您需要删除镜像</span>`,\r\n      icon: 'info',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#5C5EE4',\r\n      confirmButtonText: '立即删除',\r\n      cancelButtonText: '取消',\r\n      customClass: {\r\n        icon: 'snapshot-del-icon',\r\n        cancelButton: 'snapshot-cancel-button',\r\n      }\r\n    }).then((result) => {\r\n      if (result.value) {\r\n        // 调用接口执行卸载\r\n        const params = {\r\n\r\n        }\r\n        // 调用删除 模板\r\n        showDialog(`您已成功删除 ${record.name}`, \"success\")\r\n        // 重新拉去模板列表\r\n      }\r\n    })\r\n  }\r\n\r\n  // 创建模板\r\n  const doCreateSnapshot = () => {\r\n\r\n  }\r\n\r\n  // 获取磁盘列表\r\n  const getDiskList = () => {\r\n\r\n  }\r\n  // 获取磁盘id\r\n  const getDiskIdValue = (e) => {\r\n    setSForm({\r\n      ...sForm,\r\n      disk_id: Number(e)\r\n    });\r\n  };\r\n  // 获取 模板名称\r\n  const getNameValue = (e) => {\r\n    setSForm({\r\n      ...sForm,\r\n      name: e.target.value,\r\n    })\r\n  }\r\n\r\n  // 打开创建模板弹窗\r\n  const showVisible = () => {\r\n    // 初始化 表单数据\r\n    setSForm({\r\n      id: 0,\r\n      name: null,\r\n      disk_id: null\r\n    })\r\n    setErrMsg(\"\")\r\n    setVisible(true)\r\n  }\r\n\r\n  useEffect(() => {\r\n    getSnapshotList()\r\n    // 获取磁盘列表\r\n  }, [])\r\n\r\n  return (\r\n    <div className='Snapshot'>\r\n      <div className=\"top\">\r\n        <div className=\"top-text\">\r\n          您可使用远程ISO文件安装系统，请再次管理您的远程ISO文件，需要使用http或https格式\r\n        </div>\r\n        <div className=\"top-btn\" onClick={showVisible}>添加ISO</div>\r\n      </div>\r\n      <div className=\"snapshot-table\">\r\n        <Table pagination={false} rowKey={record => record.id} loading={loading} columns={columns} dataSource={data}></Table>\r\n      </div>\r\n      {/* 创建模板弹窗 */}\r\n\r\n      <Modal\r\n        visible={visible}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        style={{ borderRadius: \"10px\", overflow: \"auto\" }}\r\n        getContainer={false}\r\n        onCancel={() => setVisible(false)}\r\n      >\r\n        <div className='create-snapshot'>\r\n          <div className=\"top\">\r\n            <div className=\"title\">\r\n              创建/编辑镜像\r\n            </div>\r\n          </div>\r\n          <div className=\"main\">\r\n            {\r\n              errMsg ?\r\n                <div className=\"err\">\r\n                  <Alert description={errMsg} type=\"error\" showIcon />\r\n                </div>\r\n                :\r\n                <div className=\"remind-text\">\r\n                  \r\n                </div>\r\n            }\r\n            <div className=\"form\">\r\n              <div className=\"row\">\r\n                <Row>\r\n                  <Col span={4}>\r\n                    <span className='label'>名称</span>\r\n                  </Col>\r\n                  <Col span={20}>\r\n                    <Input size='large' placeholder=\"请输入模板名称\" onChange={getNameValue} />\r\n                  </Col>\r\n                  {/* <Col span={10}>\r\n                    <Select size='large' onChange={getDiskIdValue} >\r\n                      {\r\n                        diskList.map(item => {\r\n                          return <Option key={item.id} value={item.id}>{`${item.name}-${item.size}G`}</Option>\r\n                        })\r\n                      }\r\n                    </Select>\r\n                  </Col> */}\r\n                </Row>\r\n              </div>\r\n              <div className=\"row\">\r\n                <Row>\r\n                  <Col span={4}>\r\n                    <span className='label'>URL</span>\r\n                  </Col>\r\n                  <Col span={20}>\r\n                    <TextArea rows={4} />\r\n                  </Col>\r\n                </Row>\r\n              </div>\r\n              <div className='remin-text'>输入您的ISO文件访问路径，必须以ISO结尾</div>\r\n            </div>\r\n          </div>\r\n          <div className=\"footer\">\r\n            <Button className='cancel-btn' onClick={() => setVisible(false)}>取消</Button>\r\n            <Button className='sub-btn' onClick={doCreateSnapshot}>立即创建</Button>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\n"],"names":["getCloudListAll","request","getDiskList","id","snapshotList","createSnapshot","params","restoreSnapshot","delSnapshot","snapshot_id","backupList","delBackup","backup_id","restoreBackup","createBackup","templateList","createTemplate","delTemplate","template_id","isoList","Iso","t","useTranslation","TextArea","Select","Input","useState","name","disk_id","sForm","setSForm","errMsg","setErrMsg","visible","setVisible","area","create_time","host_name","country","country_code","city","data","setData","columns","title","dataIndex","key","ellipsis","width","minWidth","render","_","record","className","getPopupContainer","document","getElementById","content","onClick","recoverItem","deleteItem","placement","EllipsisOutlined","loading","setLoading","Swal","html","moment","format","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","customClass","cancelButton","then","result","value","icon","showDialog","useEffect","res","status","list","pagination","rowKey","dataSource","footer","centered","closable","style","borderRadius","overflow","getContainer","onCancel","description","type","showIcon","span","size","placeholder","onChange","e","target","rows"],"sourceRoot":""}